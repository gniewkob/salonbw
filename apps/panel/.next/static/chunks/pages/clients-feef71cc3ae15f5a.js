(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[839],{1630:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clients",function(){return n(9280)}])},3464:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(1549),r=n(4194);function a(e){let{data:t,columns:n,initialSort:a,renderActions:c,pageSize:i=10}=e,[l,o]=(0,r.useState)(""),[d,u]=(0,r.useState)(a),[h,m]=(0,r.useState)("asc"),[p,f]=(0,r.useState)(0),x=t.filter(e=>n.some(t=>String(e[t.accessor]).toLowerCase().includes(l.toLowerCase()))),y=d?[...x].sort((e,t)=>{let n=e[d],s=t[d];return n===s?0:"asc"===h?n>s?1:-1:n<s?1:-1}):x,j=y.slice(p*i,(p+1)*i),b=Math.ceil(y.length/i),N=e=>{d===e?m("asc"===h?"desc":"asc"):(u(e),m("asc"))};return(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{placeholder:"Search",value:l,onChange:e=>o(e.target.value),className:"border p-1 mb-2"}),(0,s.jsxs)("table",{className:"min-w-full border",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-50",children:[n.map(e=>(0,s.jsxs)("th",{className:"p-2 text-left cursor-pointer",onClick:()=>N(e.accessor),children:[e.header,d===e.accessor&&("asc"===h?" ▲":" ▼")]},String(e.accessor))),(0,s.jsx)("th",{className:"p-2"})]})}),(0,s.jsx)("tbody",{children:j.map((e,t)=>(0,s.jsxs)("tr",{className:"border-t",children:[n.map(t=>(0,s.jsx)("td",{className:"p-2",children:String(e[t.accessor])},String(t.accessor))),(0,s.jsx)("td",{className:"p-2",children:c?c(e):null})]},t))})]}),(0,s.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,s.jsx)("button",{disabled:0===p,onClick:()=>f(e=>Math.max(e-1,0)),className:"border px-2 py-1",children:"Prev"}),(0,s.jsxs)("span",{children:[p+1," / ",b||1]}),(0,s.jsx)("button",{disabled:p+1>=b,onClick:()=>f(e=>Math.min(e+1,b-1)),className:"border px-2 py-1",children:"Next"})]})]})}},2592:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(1549),r=n(4194);function a(e){let{open:t,onClose:n,children:a}=e;return((0,r.useEffect)(()=>{if("undefined"==typeof document)return;let e=e=>{"Escape"===e.key&&n()};return t&&document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,n]),t)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:(0,s.jsx)("div",{role:"dialog",className:"bg-white p-4 rounded shadow min-w-[300px]",children:a})}):null}},6982:function(e,t,n){"use strict";n.d(t,{s:function(){return c}});var s=n(70),r=n(1247);let a=e=>["api",e];function c(e){var t,n;let{apiFetch:c}=(0,r.a)(),i=(0,s.a)({queryKey:a(e),queryFn:()=>c(e)});return{data:null!==(t=i.data)&&void 0!==t?t:null,error:null!==(n=i.error)&&void 0!==n?n:null,loading:i.isLoading,refetch:i.refetch,queryKey:a(e)}}},9280:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var s=n(1549),r=n(4194),a=n(7666),c=n.n(a),i=n(8583),l=n(1554),o=n(3464),d=n(2592),u=n(6982),h=n(1247),m=n(2806);let p=c()(()=>n.e(35).then(n.bind(n,6035)),{loadableGenerated:{webpack:()=>[6035]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"p-4 text-sm text-gray-500",children:"Loading client form…"})});function f(){let{data:e}=(0,u.s)("/clients"),t=function(){let{apiFetch:e}=(0,h.a)(),t=(0,m.p)();return{create:async n=>{try{let s=await e("/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return t.success("Client created"),s}catch(e){throw t.error(e instanceof Error?e.message:"Error"),e}},update:async(n,s)=>{try{let r=await e("/clients/".concat(n),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return t.success("Client updated"),r}catch(e){throw t.error(e instanceof Error?e.message:"Error"),e}},remove:async n=>{try{await e("/clients/".concat(n),{method:"DELETE"}),t.success("Client deleted")}catch(e){throw t.error(e instanceof Error?e.message:"Error"),e}}}}(),[n,a]=(0,r.useState)([]),[c,f]=(0,r.useState)(!1),[x,y]=(0,r.useState)(null);e&&0===n.length&&a(e);let j=async e=>{let n=await t.create(e);a(e=>[...e,n]),f(!1)},b=async e=>{if(!x)return;let n=await t.update(x.id,e);a(e=>e.map(e=>e.id===x.id?n:e)),y(null),f(!1)},N=async e=>{confirm("Delete ".concat(e.name,"?"))&&(await t.remove(e.id),a(t=>t.filter(t=>t.id!==e.id)))};return(0,s.jsx)(i.Z,{roles:["admin"],permission:"nav:clients",children:(0,s.jsxs)(l.Z,{children:[(0,s.jsx)("div",{className:"mb-2 flex justify-end",children:(0,s.jsx)("button",{className:"border px-2 py-1",onClick:()=>{y(null),f(!0)},children:"Add Client"})}),n&&(0,s.jsx)(o.Z,{data:n,columns:[{header:"ID",accessor:"id"},{header:"Name",accessor:"name"}],initialSort:"id",renderActions:e=>(0,s.jsxs)("span",{className:"space-x-2",children:[(0,s.jsx)("button",{className:"border px-2 py-1",onClick:()=>{y(e),f(!0)},children:"Edit"}),(0,s.jsx)("button",{className:"border px-2 py-1",onClick:()=>void N(e),children:"Delete"})]})}),(0,s.jsx)(d.Z,{open:c||!!x,onClose:()=>{f(!1),y(null)},children:(0,s.jsx)(p,{initial:null!=x?x:void 0,onCancel:()=>{f(!1),y(null)},onSubmit:x?b:j})})]})})}}},function(e){e.O(0,[282,966,888,774,179],function(){return e(e.s=1630)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[471],{2039:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/employees",function(){return s(637)}])},3464:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(1549),n=s(4194);function a(e){let{data:t,columns:s,initialSort:a,renderActions:c,pageSize:l=10}=e,[i,o]=(0,n.useState)(""),[d,u]=(0,n.useState)(a),[m,p]=(0,n.useState)("asc"),[h,f]=(0,n.useState)(0),y=t.filter(e=>s.some(t=>String(e[t.accessor]).toLowerCase().includes(i.toLowerCase()))),x=d?[...y].sort((e,t)=>{let s=e[d],r=t[d];return s===r?0:"asc"===m?s>r?1:-1:s<r?1:-1}):y,j=x.slice(h*l,(h+1)*l),b=Math.ceil(x.length/l),N=e=>{d===e?p("asc"===m?"desc":"asc"):(u(e),p("asc"))};return(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{placeholder:"Search",value:i,onChange:e=>o(e.target.value),className:"border p-1 mb-2"}),(0,r.jsxs)("table",{className:"min-w-full border",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50",children:[s.map(e=>(0,r.jsxs)("th",{className:"p-2 text-left cursor-pointer",onClick:()=>N(e.accessor),children:[e.header,d===e.accessor&&("asc"===m?" ▲":" ▼")]},String(e.accessor))),(0,r.jsx)("th",{className:"p-2"})]})}),(0,r.jsx)("tbody",{children:j.map((e,t)=>(0,r.jsxs)("tr",{className:"border-t",children:[s.map(t=>(0,r.jsx)("td",{className:"p-2",children:String(e[t.accessor])},String(t.accessor))),(0,r.jsx)("td",{className:"p-2",children:c?c(e):null})]},t))})]}),(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,r.jsx)("button",{disabled:0===h,onClick:()=>f(e=>Math.max(e-1,0)),className:"border px-2 py-1",children:"Prev"}),(0,r.jsxs)("span",{children:[h+1," / ",b||1]}),(0,r.jsx)("button",{disabled:h+1>=b,onClick:()=>f(e=>Math.min(e+1,b-1)),className:"border px-2 py-1",children:"Next"})]})]})}},2592:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(1549),n=s(4194);function a(e){let{open:t,onClose:s,children:a}=e;return((0,n.useEffect)(()=>{if("undefined"==typeof document)return;let e=e=>{"Escape"===e.key&&s()};return t&&document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,s]),t)?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center",children:(0,r.jsx)("div",{role:"dialog",className:"bg-white p-4 rounded shadow min-w-[300px]",children:a})}):null}},6982:function(e,t,s){"use strict";s.d(t,{s:function(){return c}});var r=s(70),n=s(1247);let a=e=>["api",e];function c(e){var t,s;let{apiFetch:c}=(0,n.a)(),l=(0,r.a)({queryKey:a(e),queryFn:()=>c(e)});return{data:null!==(t=l.data)&&void 0!==t?t:null,error:null!==(s=l.error)&&void 0!==s?s:null,loading:l.isLoading,refetch:l.refetch,queryKey:a(e)}}},637:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var r=s(1549),n=s(4194),a=s(7666),c=s.n(a),l=s(8583),i=s(1554),o=s(3464),d=s(2592),u=s(6982),m=s(1247),p=s(2806);let h=c()(()=>s.e(529).then(s.bind(s,529)),{loadableGenerated:{webpack:()=>[529]},ssr:!1,loading:()=>(0,r.jsx)("div",{className:"p-4 text-sm text-gray-500",children:"Loading employee form…"})});function f(){let{data:e}=(0,u.s)("/employees"),t=function(){let{apiFetch:e}=(0,m.a)(),t=(0,p.p)();return{create:async s=>{try{let r=await e("/employees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return t.success("Employee created"),r}catch(e){throw t.error(e instanceof Error?e.message:"Error"),e}},update:async(s,r)=>{try{let n=await e("/employees/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return t.success("Employee updated"),n}catch(e){throw t.error(e instanceof Error?e.message:"Error"),e}},remove:async s=>{try{await e("/employees/".concat(s),{method:"DELETE"}),t.success("Employee deleted")}catch(e){throw t.error(e instanceof Error?e.message:"Error"),e}}}}(),[s,a]=(0,n.useState)([]),[c,f]=(0,n.useState)(!1),[y,x]=(0,n.useState)(null);e&&0===s.length&&a(e);let j=async e=>{let s=await t.create(e);a(e=>[...e,s]),f(!1)},b=async e=>{if(!y)return;let s=await t.update(y.id,e);a(e=>e.map(e=>e.id===y.id?s:e)),x(null),f(!1)},N=async e=>{confirm("Delete ".concat(e.fullName,"?"))&&(await t.remove(e.id),a(t=>t.filter(t=>t.id!==e.id)))};return(0,r.jsx)(l.Z,{roles:["admin"],permission:"nav:employees",children:(0,r.jsxs)(i.Z,{children:[(0,r.jsx)("div",{className:"mb-2 flex justify-end",children:(0,r.jsx)("button",{className:"border px-2 py-1",onClick:()=>{x(null),f(!0)},children:"Add Employee"})}),s&&(0,r.jsx)(o.Z,{data:s,columns:[{header:"ID",accessor:"id"},{header:"Name",accessor:"fullName"}],initialSort:"id",renderActions:e=>(0,r.jsxs)("span",{className:"space-x-2",children:[(0,r.jsx)("button",{className:"border px-2 py-1",onClick:()=>{x(e),f(!0)},children:"Edit"}),(0,r.jsx)("button",{className:"border px-2 py-1",onClick:()=>void N(e),children:"Delete"})]})}),(0,r.jsx)(d.Z,{open:c||!!y,onClose:()=>{f(!1),x(null)},children:(0,r.jsx)(h,{initial:null!=y?y:void 0,onCancel:()=>{f(!1),x(null)},onSubmit:y?b:j})})]})})}}},function(e){e.O(0,[282,966,888,774,179],function(){return e(e.s=2039)}),_N_E=e.O()}]);
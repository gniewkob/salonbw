Deploy api	Validate DB connectivity (api)	Ôªø2025-12-14T21:16:06.9733691Z ##[group]Run ssh -i ~/.ssh/mydevil -o IdentitiesOnly=yes ***@*** <<'REMOTE_CMDS'
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9734884Z [36;1mssh -i ~/.ssh/mydevil -o IdentitiesOnly=yes ***@*** <<'REMOTE_CMDS'[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9735665Z [36;1mset -euo pipefail[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9736357Z [36;1mREMOTE_PATH='/home/***/apps/nodejs***_salonbw'[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9736990Z [36;1mcd "$REMOTE_PATH"[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9737615Z [36;1mecho "Testing DB connectivity using DATABASE_URL..."[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9738522Z [36;1mif command -v node22 >/dev/null 2>&1; then NODECMD=node22; else NODECMD=node; fi[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9743383Z [36;1m"${NODECMD}" -e "require('dotenv').config();(async()=>{const {Client}=require('pg');const ssl=process.env.PGSSL==='1'?***:undefined;let cfg=null;if(process.env.DATABASE_URL){cfg={connectionString:process.env.DATABASE_URL,ssl};}else{cfg={host:process.env.PGHOST||process.env.DB_HOST||'pgsql0',port:Number(process.env.PGPORT||process.env.DB_PORT||***),user:process.env.PGUSER||process.env.DB_USER,password:process.env.PGPASSWORD||process.env.DB_PASS,database:process.env.PGDATABASE||process.env.DB_NAME,ssl};}console.log('DB probe cfg',{host:cfg.host||'[url]',port:cfg.port||'[url]',user:cfg.user||'[url]',database:cfg.database||'[url]'});try{const c=new Client(cfg);await c.connect();const r=await c.query('SELECT 1 AS ok');console.log('DB OK',r.rows[0]);await c.end();}catch(e){console.error('DB FAIL',e&& (e.stack||e.message)||e);process.exit(3);}})()"[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9747857Z [36;1mREMOTE_CMDS[0m
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9777810Z shell: /usr/bin/bash -e {0}
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9778389Z env:
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9779005Z   PNPM_VERSION: 10.14.0
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9779499Z   NODE_VERSION: 22
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9779957Z   DEPLOY_ENV: staging
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9780562Z   PNPM_HOME: /home/runner/setup-pnpm/node_modules/.bin
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9781442Z ##[endgroup]
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:06.9869321Z Pseudo-terminal will not be allocated because stdin is not a terminal.
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:08.9996107Z Testing DB connectivity using DATABASE_URL...
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.0636774Z [dotenv@17.2.3] injecting env (23) from .env -- tip: üîê encrypt with Dotenvx: https://dotenvx.com
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.0961105Z DB probe cfg { host: '[url]', port: '[url]', user: '[url]', database: '[url]' }
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1198483Z DB FAIL error: password authentication failed for user "***"
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1200118Z     at Parser.parseErrorMessage (/usr/home/***/apps/nodejs***_salonbw/node_modules/pg-protocol/dist/parser.js:285:98)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1201096Z     at Parser.handlePacket (/usr/home/***/apps/nodejs***_salonbw/node_modules/pg-protocol/dist/parser.js:122:29)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1201925Z     at Parser.parse (/usr/home/***/apps/nodejs***_salonbw/node_modules/pg-protocol/dist/parser.js:35:38)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1202724Z     at Socket.<anonymous> (/usr/home/***/apps/nodejs***_salonbw/node_modules/pg-protocol/dist/index.js:11:42)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1203281Z     at Socket.emit (node:events:518:28)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1203708Z     at addChunk (node:internal/streams/readable:561:12)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1204215Z     at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1204740Z     at Readable.push (node:internal/streams/readable:392:5)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1205217Z     at TCP.onStreamRead (node:internal/stream_base_commons:189:23)
Deploy api	Validate DB connectivity (api)	2025-12-14T21:16:09.1254773Z ##[error]Process com***eted with exit code 3.
